<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <script>
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.setAttribute('data-theme', 'dark');
        } else {
            document.documentElement.setAttribute('data-theme', 'light');
        }
    </script>
    <title>Nenya - Screenshot Editor</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Gloria+Hallelujah&family=Pacifico&family=SN+Pro:ital,wght@0,200..900;1,200..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../libs/daisyui@5.css">
    <link rel="stylesheet" href="../libs/daisyui@5-themes.css">
    <link rel="stylesheet" href="./editor.css">
    <script src="../libs/tailwindcss@4.js"></script>
    <style>
        /* Removed image-rendering: pixelated for better preview quality */
    </style>
</head>

<body class="bg-base-200 h-screen flex flex-col overflow-hidden">
    <!-- Toolbar -->
    <header class="glass-nav z-20 px-4 flex items-center justify-between shrink-0 h-[52px]">
        <div class="flex items-center gap-3">
            <!-- Main Tools -->
            <div class="flex items-center bg-base-300/30 rounded-xl p-1 gap-1">
                <button class="btn btn-sm btn-ghost btn-square tool-btn" id="tool-select" title="Select (S/V)">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <path d="m3 3 7.07 16.97 2.51-7.39 7.39-2.51L3 3z" />
                        <path d="m13 13 6 6" />
                    </svg>
                    <span class="shortcut-badge">S</span>
                </button>
                <button class="btn btn-sm btn-ghost btn-square tool-btn" id="tool-pan" title="Pan (Q / Space)">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M18 11V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v0" />
                        <path d="M14 10V4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v0" />
                        <path d="M10 10.5V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v0" />
                        <path
                            d="M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15" />
                    </svg>
                    <span class="shortcut-badge">Q</span>
                </button>
                <div class="divider-vertical opacity-20"></div>
                <button class="btn btn-sm btn-ghost btn-square tool-btn" id="tool-crop" title="Crop (C)">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M6 2v14a2 2 0 0 0 2 2h14" />
                        <path d="M18 22V8a2 2 0 0 0-2-2H2" />
                    </svg>
                    <span class="shortcut-badge">C</span>
                </button>
                <button class="btn btn-sm btn-ghost btn-square tool-btn" id="tool-arrow" title="Arrow (A)">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M7 7h10v10" />
                        <path d="M7 17 17 7" />
                    </svg>
                    <span class="shortcut-badge">A</span>
                </button>
                <button class="btn btn-sm btn-ghost btn-square tool-btn" id="tool-rect" title="Rectangle (R)">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <rect width="18" height="18" x="3" y="3" rx="2" />
                    </svg>
                    <span class="shortcut-badge">R</span>
                </button>
                <button class="btn btn-sm btn-ghost btn-square tool-btn" id="tool-highlight" title="Highlight (H)">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M9 11l-6 6v3h9l3-3" />
                        <path d="m22 12-4.6 4.6a2 2 0 0 1-2.8 0l-5.2-5.2a2 2 0 0 1 0-2.8L14 4" />
                    </svg>
                    <span class="shortcut-badge">H</span>
                </button>
                <button class="btn btn-sm btn-ghost btn-square tool-btn" id="tool-text" title="Text (T)">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="4 7 4 4 20 4 20 7" />
                        <line x1="9" x2="15" y1="20" y2="20" />
                        <line x1="12" x2="12" y1="4" y2="20" />
                    </svg>
                    <span class="shortcut-badge">T</span>
                </button>
                <button class="btn btn-sm btn-ghost btn-square tool-btn" id="tool-blur" title="Blur (B)">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10" />
                        <path d="M14.5 9a2.5 2.5 0 0 0-5 0v3a2.5 2.5 0 0 0 5 0z" />
                    </svg>
                    <span class="shortcut-badge">B</span>
                </button>
            </div>

            <div class="divider-vertical opacity-50"></div>

            <!-- Zoom Controls -->
            <div class="flex items-center gap-1.5 px-1">
                <button class="btn btn-[10px] btn-ghost btn-square size-7" id="zoom-out" title="Zoom Out">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M5 12h14" />
                    </svg>
                </button>
                <span class="text-[11px] font-bold min-w-[36px] text-center tabular-nums" id="zoom-level">100%</span>
                <button class="btn btn-[10px] btn-ghost btn-square size-7" id="zoom-in" title="Zoom In">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 5v14" />
                        <path d="M5 12h14" />
                    </svg>
                </button>
                <button class="btn btn-xs btn-ghost gap-1 px-2 h-7 min-h-7" id="zoom-fit" title="Fit to Screen">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M8 3H5a2 2 0 0 0-2 2v3" />
                        <path d="M21 8V5a2 2 0 0 0-2-2h-3" />
                        <path d="M3 16v3a2 2 0 0 0 2 2h3" />
                        <path d="M16 21h3a2 2 0 0 0 2-2v-3" />
                    </svg>
                    <span class="text-[10px] font-bold uppercase tracking-wider">Fit</span>
                </button>
            </div>
        </div>

        <!-- Right: Properties & Actions -->
        <div class="flex items-center gap-4">
            <!-- Properties Panel -->
            <div class="flex items-center gap-4" id="properties-panel">
                <div class="flex items-center gap-1.5">
                    <div class="flex flex-col items-center">
                        <span class="prop-label">Color</span>
                        <div class="flex items-center gap-2">
                            <input type="color" id="prop-color" class="input-color-custom" value="#ff0000"
                                title="Custom Color">
                            <div class="color-presets" id="color-presets">
                                <div class="color-preset" style="background: #ff0000;" data-color="#ff0000" title="Red">
                                </div>
                                <div class="color-preset" style="background: #00ff00;" data-color="#00ff00"
                                    title="Green"></div>
                                <div class="color-preset" style="background: #0000ff;" data-color="#0000ff"
                                    title="Blue"></div>
                                <div class="color-preset" style="background: #ffff00;" data-color="#ffff00"
                                    title="Yellow"></div>
                                <div class="color-preset" style="background: #ffffff;" data-color="#ffffff"
                                    title="White"></div>
                                <div class="color-preset" style="background: #000000;" data-color="#000000"
                                    title="Black"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flex flex-col w-14" id="stroke-prop">
                    <span class="prop-label">Stroke</span>
                    <input type="range" id="prop-stroke" min="1" max="200" step="1" value="4"
                        class="range range-xs range-primary range-compact" title="Stroke Thickness">
                </div>

                <div class="flex flex-col w-14">
                    <span class="prop-label">Alpha</span>
                    <input type="range" id="prop-opacity" min="0.1" max="1" step="0.1" value="1"
                        class="range range-xs range-primary range-compact" title="Opacity">
                </div>
            </div>

            <!-- Text Specific -->
            <div id="text-props" class="flex items-center gap-2 hidden">
                <div class="divider-vertical opacity-20"></div>
                <div class="flex flex-col">
                    <span class="prop-label">Font</span>
                    <select id="prop-font-family"
                        class="select select-bordered select-[10px] w-36 h-6 min-h-6 py-0 px-1 leading-tight">
                        <option value="Arial" style="font-family: Arial, sans-serif;">Arial</option>
                        <option value="SN Pro" style="font-family: 'SN Pro', sans-serif;">SN Pro</option>
                        <option value="Pacifico" style="font-family: 'Pacifico', cursive;">Pacifico</option>
                        <option value="Gloria Hallelujah" style="font-family: 'Gloria Hallelujah', cursive;">Gloria Hallelujah</option>
                    </select>
                </div>
                <div class="flex flex-col">
                    <span class="prop-label">Size</span>
                    <input type="number" id="prop-font-size"
                        class="input input-bordered input-[10px] w-12 h-6 min-h-6 py-0 px-1" value="24" min="8"
                        max="1000">
                </div>
                <div class="flex items-center gap-0.5 mt-auto pb-0">
                    <button class="btn btn-xs btn-ghost btn-square h-6 w-6 min-h-6" id="prop-bold" title="Bold">
                        <span class="font-bold text-xs">B</span>
                    </button>
                    <button class="btn btn-xs btn-ghost btn-square h-6 w-6 min-h-6 italic" id="prop-italic"
                        title="Italic">
                        <span class="text-xs">I</span>
                    </button>
                    <button class="btn btn-xs btn-ghost btn-square h-6 w-6 min-h-6 underline" id="prop-underline"
                        title="Underline">
                        <span class="text-xs">U</span>
                    </button>
        <button id="prop-border" class="btn btn-xs btn-ghost btn-square h-6 w-6 min-h-6" title="Text Border">
          <svg viewBox="0 0 24 24" width="14" height="14">
            <path d="M5 4v3h5.5v12h3V7H19V4z" fill="currentColor" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/>
          </svg>
        </button>
                </div>
            </div>
            <div class="divider-vertical opacity-20"></div>

            <div class="flex items-center gap-1">
                <button class="btn btn-sm btn-ghost btn-square" id="action-undo" title="Undo (Cmd+Z)">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M3 7v6h6" />
                        <path d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13" />
                    </svg>
                </button>
                <button class="btn btn-sm btn-ghost btn-square" id="action-redo" title="Redo (Cmd+Shift+Z)">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 7v6h-6" />
                        <path d="M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7" />
                    </svg>
                </button>
            </div>

            <button class="btn btn-sm btn-ghost btn-square text-error/70 hover:text-error" id="action-delete"
                title="Delete Selected (Del)" disabled>
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M3 6h18" />
                    <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6" />
                    <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2" />
                    <line x1="10" x2="10" y1="11" y2="17" />
                    <line x1="14" x2="14" y1="11" y2="17" />
                </svg>
            </button>
        </div>

        <div class="divider-vertical opacity-50"></div>

        <div class="flex items-center gap-2">
            <button class="btn btn-sm btn-outline btn-secondary h-8 min-h-8 px-3 gap-1.5" id="action-copy">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                    <rect width="14" height="14" x="8" y="8" rx="2" ry="2" />
                    <path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2" />
                </svg>
                <span class="text-xs font-bold uppercase tracking-tight">Copy</span>
            </button>
            <button class="btn btn-sm btn-primary h-8 min-h-8 px-3 gap-1.5 shadow-lg shadow-primary/20"
                id="action-save">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                    <polyline points="7 10 12 15 17 10" />
                    <line x1="12" x2="12" y1="15" y2="3" />
                </svg>
                <span class="text-xs font-bold uppercase tracking-tight">Save</span>
            </button>
        </div>
        </div>
    </header>

    <!-- Canvas Container -->
    <main class="flex-1 relative overflow-hidden bg-base-300/10" id="canvas-container">
        <canvas id="editor-canvas" class="shadow-2xl bg-white"></canvas>
    </main>

    <!-- Text Input Dialog -->
    <dialog id="text-dialog" class="modal">
        <div class="modal-box max-w-md">
            <h3 id="text-dialog-title" class="font-bold text-lg mb-4">Enter Text</h3>
            <textarea id="text-dialog-input" autofocus
                class="textarea textarea-bordered w-full h-40 resize-y text-base leading-relaxed" 
                placeholder="Enter your text here...&#10;Press Enter for new lines"></textarea>
            <p class="text-xs text-base-content/50 mt-2">
                <kbd class="kbd kbd-xs">Enter</kbd> for new line &nbsp;&bull;&nbsp;
                <kbd class="kbd kbd-xs">Ctrl</kbd>+<kbd class="kbd kbd-xs">Enter</kbd> to confirm
            </p>
            <div class="modal-action">
                <button id="text-dialog-cancel" class="btn btn-ghost">Cancel</button>
                <button id="text-dialog-confirm" class="btn btn-primary">Confirm</button>
            </div>
        </div>
        <form method="dialog" class="modal-backdrop">
            <button>close</button>
        </form>
    </dialog>

    <script src="./editor.js" type="module"></script>
</body>

</html>